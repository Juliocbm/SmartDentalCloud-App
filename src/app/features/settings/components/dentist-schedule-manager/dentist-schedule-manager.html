<div class="dentist-schedule-manager">
  <div class="section-header">
    <h3 class="section-title">
      <i class="fa-solid fa-user-doctor"></i>
      Horarios por Dentista
    </h3>
    <p class="section-description">Configura horarios individuales para cada dentista. Si un dentista no tiene horario propio, se usa el horario del consultorio.</p>
  </div>

  @if (loadingDentists()) {
    <div class="loading-state">
      <i class="fa-solid fa-spinner fa-spin fa-2x"></i>
      <p>Cargando dentistas...</p>
    </div>
  } @else if (dentists().length === 0) {
    <div class="empty-state">
      <i class="fa-solid fa-user-doctor"></i>
      <p>No hay dentistas registrados en el sistema</p>
    </div>
  } @else {
    <div class="form-group dentist-selector">
      <label class="form-label">Seleccionar Dentista</label>
      <select
        class="form-input"
        [ngModel]="selectedDentistId() ?? ''"
        (ngModelChange)="onDentistChange($event)">
        <option value="">— Selecciona un dentista —</option>
        @for (dentist of dentists(); track dentist.id) {
          <option [value]="dentist.id">
            {{ dentist.name }}
            @if (dentist.specialization) {
              ({{ dentist.specialization }})
            }
          </option>
        }
      </select>
    </div>

    @if (selectedDentistId()) {
      <div class="dentist-editor">
        <app-work-schedule-editor
          #dentistScheduleEditor
          [userId]="selectedDentistId()"
          [title]="'Horario de ' + selectedDentistName()"
          [description]="'Horario de atención individual. Si no se configura, se usa el horario del consultorio.'"
        />
      </div>
    } @else {
      <div class="schedule-skeleton">
        <div class="skeleton-header">
          <span class="skeleton-bar skeleton-title"></span>
          <span class="skeleton-bar skeleton-desc"></span>
        </div>
        <div class="skeleton-table">
          <div class="skeleton-thead">
            <span class="skeleton-bar"></span>
            <span class="skeleton-bar"></span>
            <span class="skeleton-bar"></span>
            <span class="skeleton-bar"></span>
          </div>
          @for (row of [1,2,3,4,5,6,7]; track row) {
            <div class="skeleton-row">
              <span class="skeleton-bar skeleton-day"></span>
              <span class="skeleton-bar skeleton-toggle"></span>
              <span class="skeleton-bar skeleton-time"></span>
              <span class="skeleton-bar skeleton-time"></span>
            </div>
          }
        </div>
        <div class="skeleton-overlay">
          <i class="fa-solid fa-hand-pointer"></i>
          <p>Selecciona un dentista para configurar su horario individual</p>
        </div>
      </div>
    }
  }
</div>
